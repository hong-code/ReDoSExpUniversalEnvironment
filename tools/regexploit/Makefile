PYTHON := python3
SOURCE_DIR := src
PIP := $(PYTHON) -m pip

.PHONY: all build clean test install-deps

# Default target
all: build

# Build the project
build:
	@echo "Building Regexploit tool..."
	@echo "Installing regexploit package from source..."
	cd $(SOURCE_DIR) && $(PIP) install -e . --no-deps
	@echo "Build completed successfully."

# Clean build artifacts
clean:
	@echo "Cleaning build artifacts..."
	cd $(SOURCE_DIR) && rm -rf build/ dist/ *.egg-info/
	$(PIP) uninstall -y regexploit || true
	@echo "Clean completed."

# Install dependencies
install-deps:
	@echo "Installing Python dependencies..."
	$(PIP) install setuptools wheel
	@echo "Dependencies installed."

# Run tests
test:
	@echo "Running Regexploit tool tests..."
	@echo "Testing with Python version..."
	$(PYTHON) --version
	cd tests && bash simple_test.sh

# Show help
help:
	@echo "Available targets:"
	@echo "  all        - Build the project (default)"
	@echo "  build      - Build and install the project"
	@echo "  clean      - Clean build artifacts"
	@echo "  test       - Run tests"
	@echo "  install-deps - Install Python dependencies"
	@echo "  help       - Show this help message" 